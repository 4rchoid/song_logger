import json
import mysql.connector

# Load JSON from a file
with open("playlist[76][36][48][6][49][41].json", "r") as f:
    data = json.load(f)

# Get first value from each inner dictionary
# first_values = {k: {v for k,v}}

# print(first_values)


data["song_id"] = data.pop("id")
data["classification"] = data.pop("class")

if "star_rating" not in data:
    row_ids = list(next(iter(data.values())).keys())  # get row ids
    data["star_rating"] = {row_id: 3 for row_id in row_ids}

# Extract field names and record indices
fields = list(data.keys())
row_ids = data[fields[0]].keys()


    
# MySQL connection setup
conn = mysql.connector.connect(
    host='localhost',
    user='archit',
    password='archit',
    database='song_logger_db'
)
cursor = conn.cursor()

# Insert data row by row
for idx in row_ids:
    values = [data[field][idx] for field in fields]
    placeholders = ', '.join(['%s'] * len(values))
    column_names = ', '.join([f"`{field}`" if field.lower() in {"key"} else field for field in fields])
    
    sql = f"INSERT INTO songs_song ({column_names}) VALUES ({placeholders})"
    cursor.execute(sql, values)

conn.commit()
cursor.close()
conn.close()
